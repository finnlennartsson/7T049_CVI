#!/bin/bash
# Input
# $1 = json-file

wfs=`cat $1 | grep WaterFatShift | awk '{print $2}' | sed 's/,//g' `
imf=`cat $1 | grep ImagingFrequency | awk '{print $2}' | sed 's/,//g' `
etl=`cat $1 | grep EchoTrainLength | awk '{print $2}' | sed 's/,//g' `

echo
echo `basename $@`
echo WaterFatShift [ppx] = $wfs
echo ImagingFrequency [Hz] = $imf
echo EPI_Factor = $etl

# Diffusion
# ActualEchoSpacing = WaterFatShift / (ImagingFrequency * 3.4 * (EPI_Factor + 1))
# ActualEchoSpacing = 31.3847/(289 * 3.4 *(45+1)) = 6.9436e-04
ActualEchoSpacing=0.00069436
# TotalReadoutTime = ActualEchoSpacing * EPI_Factor
# TotalReadoutTime = 0.00069436 * 45 = 0.031
TotalReadoutTime=0.0312
echo
echo "Diffusion and SE-EPI fieldmaps have"
echo "ActualEchoSpacing [s] = $ActualEchoSpacing"
echo "TotalReadoutTime [s] = $TotalReadoutTime"

# fMRI
# ActualEchoSpacing = WaterFatShift / (ImagingFrequency * 3.4 * (EPI_Factor + 1))
# ActualEchoSpacing = 25.915/(289 * 3.4 *(37+1)) = 6.9405e-04
ActualEchoSpacing=0.00069405
# TotalReadoutTime = ActualEchoSpacing * EPI_Factor
# TotalReadoutTime = 0.00069405 * 37 = 0.031
TotalReadoutTime=0.0257
echo
echo "fMRI"
echo "ActualEchoSpacing [s] = $ActualEchoSpacing"
echo "TotalReadoutTime [s] = $TotalReadoutTime"

